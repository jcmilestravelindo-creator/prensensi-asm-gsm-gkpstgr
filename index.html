<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Absensi Kasih PRO</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{
    margin:0;
    font-family:Poppins,sans-serif;
    background:linear-gradient(#87CEEB,#E0F7FF);
}

.header{
    text-align:center;
    padding:15px;
    font-weight:700;
    font-size:20px;
    background:#38BDF8;
    color:white;
}

.card{
    background:white;
    margin:15px;
    padding:20px;
    border-radius:18px;
    box-shadow:0 5px 15px rgba(0,0,0,0.1);
    text-align:center;
}

.btn{
    background:#0EA5E9;
    color:white;
    border:none;
    padding:14px;
    border-radius:12px;
    width:100%;
    font-size:16px;
    margin-top:10px;
}

.nav{
    position:fixed;
    bottom:0;
    width:100%;
    background:white;
    display:flex;
    justify-content:space-around;
    padding:10px 0;
}

.screen{display:none;}
.active{display:block;}

#reader{
    width:100%;
}

ul{
    text-align:left;
}

@media(min-width:768px){
.container{max-width:500px;margin:auto;}
}
</style>
</head>

<body>

<div class="header">üôè Absensi Kasih PRO</div>

<div class="container">

<!-- HOME -->
<div id="home" class="screen active">
<div class="card">
<h2>Selamat Datang üôè</h2>
<p id="tanggal"></p>

<button class="btn" onclick="manualAbsen()">Absen Manual</button>

<p>Total Hadir:</p>
<h1 id="count">0</h1>
</div>
</div>

<!-- SCAN -->
<div id="scan" class="screen">
<div class="card">
<h3>Scan QR Absensi</h3>
<div id="reader"></div>
</div>
</div>

<!-- RIWAYAT -->
<div id="history" class="screen">
<div class="card">
<h3>Riwayat Absensi</h3>
<ul id="log"></ul>
<button class="btn" onclick="clearData()">Hapus Data</button>
</div>
</div>

</div>

<!-- NAV -->
<div class="nav">
<button onclick="show('home')">Home</button>
<button onclick="startScan()">Scan</button>
<button onclick="show('history');loadLog()">Riwayat</button>
</div>

<script>
let data = JSON.parse(localStorage.getItem("absensi")||"[]");

function save(){
localStorage.setItem("absensi",JSON.stringify(data));
document.getElementById("count").innerText=data.length;
}

save();

function show(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

function addData(name){
let item={
nama:name,
waktu:new Date().toLocaleString()
};
data.push(item);
save();
alert("Absensi masuk: "+name+" üôè");
}

function manualAbsen(){
let nama=prompt("Nama:");
if(nama) addData(nama);
}

function loadLog(){
let ul=document.getElementById("log");
ul.innerHTML="";
data.forEach(d=>{
let li=document.createElement("li");
li.innerText=d.nama+" - "+d.waktu;
ul.appendChild(li);
});
}

function clearData(){
localStorage.clear();
data=[];
save();
loadLog();
}

function startScan(){
show('scan');

const qr=new Html5Qrcode("reader");

qr.start(
{facingMode:"environment"},
{fps:10,qrbox:250},
(decodedText)=>{
addData(decodedText);
qr.stop();
show('home');
},
()=>{}
);
}

document.getElementById("tanggal").innerText=
new Date().toLocaleDateString("id-ID",{weekday:'long',day:'numeric',month:'long',year:'numeric'});
</script>

</body>
</html>
